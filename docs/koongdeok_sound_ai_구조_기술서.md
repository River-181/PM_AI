# 📘 **Koongdeok-soundAI 모델 기술서 (세부 구조 포함 완전판)**

---

## 🧩 **모델 개요**

* **모델명:** Koongdeok-soundAI 5
* **모델 구조:** Sound Preprocessor → CNN Feature Extractor → Linear Classifier
* **형식:** Core ML Package (.mlpackage)
* **모델 크기:** 약 **6.7 MB**
* **플랫폼:** macOS / iOS / watchOS / tvOS / visionOS
* **기반:** Create ML 사운드 분석 파이프라인
* **입력:** 오디오 샘플 (float32, 15,600개)
* **출력:** 클래스 라벨(`target`), 확률(`targetProbability`)

---

## 🎧 **전체 아키텍처 요약**

| 단계 | 구성 요소                                     | 주요 입력/출력                        | 설명                     |
| -- | ----------------------------------------- | ------------------------------- | ---------------------- |
| ①  | **Input [0x0]**                           | `15600×float32`                 | 마이크 입력 오디오 수신          |
| ②  | **Sound Preprocessor [0x1]**              | 입력 → `1×96×64×float32`          | 파형을 스펙트로그램으로 변환 및 정규화  |
| ③  | **model1 [0x13] (CNN Feature Extractor)** | 입력: 스펙트로그램<br>출력: 12,288차원 벡터   | 합성곱 신경망(CNN)을 통한 특징 추출 |
| ④  | **Flatten [0x12]**                        | CNN 결과 평탄화                      | 2D 특징맵을 1D 벡터로 변환      |
| ⑤  | **Linear Classifier [0x14]**              | 입력: 12,288차원<br>출력: 22클래스       | GLM(Linear) 기반 사운드 분류기 |
| ⑥  | **Output [0x15, 0x16]**                   | `target`, `targetProbabilities` | 최종 결과 출력               |

---

## 🧠 **CNN 내부 구조 세부표 (model1 [0x13])**

| 순서 | 계층명                | 입력 채널 | 출력 채널 | 커널 크기 | 파라미터 수    | 용량    | 기능              |
| -- | ------------------ | ----- | ----- | ----- | --------- | ----- | --------------- |
| 1  | **Conv1 [0x2]**    | 1     | 64    | 3×3   | 576       | 576B  | 기본 음향 패턴 감지     |
| 2  | **ReLU [0x3]**     | -     | -     | -     | -         | -     | 활성화 (비선형성 부여)   |
| 3  | **MaxPool [0x4]**  | -     | -     | 2×2   | -         | -     | 크기 축소, 노이즈 제거   |
| 4  | **Conv2 [0x5]**    | 64    | 128   | 3×3   | 73,728    | 72KB  | 중간 수준 특징 추출     |
| 5  | **ReLU [0x6]**     | -     | -     | -     | -         | -     | 활성화             |
| 6  | **MaxPool [0x7]**  | -     | -     | 2×2   | -         | -     | 시간·주파수 축소       |
| 7  | **Conv3_1 [0x8]**  | 128   | 256   | 3×3   | 294,912   | 288KB | 고차 음향 표현 학습     |
| 8  | **ReLU [0x9]**     | -     | -     | -     | -         | -     | 활성화             |
| 9  | **Conv3_2 [0xa]**  | 256   | 256   | 3×3   | 589,824   | 576KB | 특징 정제 및 강화      |
| 10 | **ReLU [0xb]**     | -     | -     | -     | -         | -     | 활성화             |
| 11 | **MaxPool [0xc]**  | -     | -     | 2×2   | -         | -     | 정보 요약           |
| 12 | **Conv4_1 [0xd]**  | 256   | 512   | 3×3   | 1,179,648 | 1.1MB | 복잡한 음향 패턴 인식    |
| 13 | **ReLU [0xe]**     | -     | -     | -     | -         | -     | 활성화             |
| 14 | **Conv4_2 [0xf]**  | 512   | 512   | 3×3   | 2,359,296 | 2.3MB | 최종 심층 특징 생성     |
| 15 | **ReLU [0x10]**    | -     | -     | -     | -         | -     | 활성화             |
| 16 | **MaxPool [0x11]** | -     | -     | 2×2   | -         | -     | 공간적 축소          |
| 17 | **Flatten [0x12]** | -     | -     | -     | -         | -     | 12,288차원 벡터로 변환 |

---

## ⚙️ **분류기 구조 (Linear Classifier [0x14])**

| 항목                   | 값                             |
| -------------------- | ----------------------------- |
| **입력 차원**            | 12,288 float32                |
| **출력 클래스**           | 22개 (가전제품, 종 등)               |
| **가중치(Weights)**     | 22×12,288 float64             |
| **오프셋(Offset)**      | 22 float64                    |
| **평가 함수(Post-eval)** | Logit                         |
| **출력 노드**            | `target`, `targetProbability` |

### 🔸 동작

* CNN의 Flatten 출력을 선형 결합(weight·x + bias)하여 각 클래스별 logit 계산
* softmax를 통해 확률화
* 최댓값을 가지는 클래스가 `target`으로 선택됨

---

## 📊 **주요 수치 요약**

| 항목                | 값                                 |
| ----------------- | --------------------------------- |
| 입력 길이             | 15,600 샘플                         |
| 스펙트로그램 크기         | 1×96×64                           |
| CNN 계층 수          | 6 (Conv) + 6 (ReLU) + 4 (Pooling) |
| Flatten 차원        | 12,288                            |
| Linear Classifier | 22클래스 (logit)                     |
| 총 파라미터 수          | 약 2.5M                            |
| 전체 모델 용량          | 약 6.7 MB                          |

---

## 🧩 **모델 동작 원리**

1. **오디오 입력:**
   마이크로부터 약 1초 길이의 파형을 수집 (`15600×float32`)
2. **전처리:**
   Sound Preprocessor가 파형을 96×64 스펙트로그램으로 변환
3. **CNN Feature Extractor:**
   합성곱과 풀링을 반복하며 점진적으로 고차원적인 소리 특징을 학습
4. **Flatten:**
   2D 특징맵을 1D 벡터로 변환 (12,288차원)
5. **Linear Classifier:**
   학습된 특징을 기반으로 22개 클래스에 대한 logit 및 확률 계산
6. **Output:**
   최종 예측 라벨(`target`)과 클래스별 확률(`targetProbability`) 출력

---

## 🔍 **모델 역할 요약**

Koongdeok-soundAI는

* 환경음, 음성, 생활소리 등을 인식하는 **멀티클래스 사운드 분류기**임.
* 입력된 소리를 CNN 기반으로 분석하고, 고유한 주파수 패턴을 학습하여
  22종의 사운드(예: 개 짖음, 문 노크, 대화, 기계음 등)를 실시간으로 식별함.
* 모바일 기기에서도 구동 가능한 **경량 사운드 인식 모델**로 설계됨.

---

## 🎤 **발표용 요약 문장**

> “Koongdeok-soundAI는 오디오 파형을 스펙트로그램으로 변환해 CNN으로 분석하고,
> 마지막에 선형 분류기로 22종의 소리를 구분하는 경량 사운드 인식 모델입니다.
> 약 6.7MB 크기지만, 환경음·음성 등 다양한 소리를 실시간으로 정확히 분류할 수 있습니다.”
